"use strict";angular.module("webappApp",["ngCookies","ngResource","ngSanitize","ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("webappApp").controller("MainCtrl",["$scope",function(a){var b=864e5;a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.targetWeight=100,a.targetDate=new Date,a.weights=[],d3.tsv("data/mockdata.tsv").row(function(a){return{date:d3.time.format("%d/%m/%Y").parse(a.date),weight:+a.weight}}).get(function(c,d){a.$apply(function(){a.weights=d,a.targetDate=new Date(a.weights[0].date.getTime()+100*b)})}),a.$watch("weights",function(){if(a.goal=[],a.weights&&0!=a.weights.length){a.startWeight=a.weights[0].weight,a.currentWeight=a.weights[a.weights.length-1].weight,a.progress=1-(a.currentWeight-a.targetWeight)/(a.startWeight-a.targetWeight);for(var c=a.weights[0].date.getTime(),d=a.targetDate.getTime(),e=Math.log(a.startWeight),f=Math.log(a.targetWeight),g=c;d>=g;g+=Math.min(b,(d-c)/100)){var h=(g-c)/(d-c);a.goal.push({date:new Date(g),weight:Math.exp(h*f+(1-h)*e)})}}})}]),angular.module("webappApp").filter("weight",function(){return function(a){return a+"kg"}}),angular.module("webappApp").directive("waWeightGraph",function(){var a={top:20,right:20,bottom:30,left:50},b=(700-a.left-a.right,400-a.top-a.bottom,"#428bca"),c="#5cb85c";return{template:"",restrict:"E",scope:{weights:"=weights",goal:"=goal"},link:function(a,d){var e=nv.models.lineChart().margin({left:55}).useInteractiveGuideline(!0).transitionDuration(350).showXAxis(!0).showYAxis(!0);e.xAxis.axisLabel("Date").showMaxMin(!1).tickFormat(function(a){return d3.time.format("%e %b %Y")(new Date(a))}),e.yAxis.axisLabel("Weight / kg").axisLabelDistance(40).tickFormat(d3.format(".0f"));var f=d3.select(d[0]).append("svg");nv.utils.windowResize(function(){e.update()});var g=function(){var d,g,h=[],i=[];for(var g in a.weights)d=a.weights[g],h.push({x:d.date,y:d.weight});for(var g in a.goal)d=a.goal[g],i.push({x:d.date,y:d.weight});f.datum([{values:i,key:"goal",color:c},{values:h,key:"weight",color:b}]).call(e)};a.$watch("weights",g),a.$watch("goal",g)}}}),angular.module("webappApp").directive("waProgressBar",function(){return{restrict:"E",templateUrl:"waprogressbar.html",scope:{min:"@",max:"@",value:"@"},link:function(){}}});